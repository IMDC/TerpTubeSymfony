{% trans_default_domain 'IMDCTerpTubeBundle' %}

    <div class="row-fluid">
   	 	<a id="record-link" class="btn btn-primary" href="{{ path('imdc_files_gateway_record_media') }}"><i class="icon-facetime-video"></i> {{ 'filesGateway.buttons.record'|trans }}</a>
        <a id="upload-audio-link" class="btn btn-primary" href="{{ path('imdc_files_gateway_audio') }}"><i class="icon-music"></i> {{ 'filesGateway.buttons.audio'|trans }}</a>
        <a class="btn btn-primary" href="{{ path('imdc_files_gateway_video') }}"><i class="icon-film"></i> {{ 'filesGateway.buttons.video'|trans }}</a>
        <a class="btn btn-primary" href="{{ path('imdc_files_gateway_image') }}"><i class=" icon-picture"></i> {{ 'filesGateway.buttons.image'|trans }}</a>
        <a class="btn btn-primary" href="{{ path('imdc_files_gateway_other') }}"><i class="icon-file-text"></i> {{ 'filesGateway.buttons.other'|trans }}</a>
    </div>
    
    <div class="row-fluid">
	<div class="span-9">
            <table id="files-table" class="table table-condensed table-hover table-striped pmtable">
                <tr><th><i class="icon-wrench"></i> Tools</th><th>Name</th><th>Type</th><th>Created</th><th>Size</th></tr>
				{%  if resourceFiles and resourceFiles|length >0 %}
						{% for resourceFile in resourceFiles %}
                   	<tr>
                        <td>
                            {% if resourceFile.getMetaData.getSize == -1 %}
                            <a class="preview-button disabled" href='#' data-type="{{ resourceFile.type }}" data-url="{{ path('imdc_files_gateway_preview', {'mediaId': resourceFile.id}) }}" data-val="{{ resourceFile.id }}"><i class="icon-play-sign"></i> {{ 'filesGateway.previewLink'|trans }}</a>
                            {% else %}
                            <a class="preview-button" href='#' data-type="{{ resourceFile.type }}" data-url="{{ path('imdc_files_gateway_preview', {'mediaId': resourceFile.id}) }}" data-val="{{ resourceFile.id }}"><i class="icon-play-sign"></i> {{ 'filesGateway.previewLink'|trans }}</a>
                            {% endif %}
                            <a class="select-button" href="#" data-val="{{ resourceFile.id }}"><i class="icon-share-alt"></i> Select</a>
                        </td>
                        <td>
                        	{{ resourceFile.title }}
                        </td>
                        <td>
                        	{{ ('filesGateway.type.'~resourceFile.type)|trans }}
                        </td>
                        <td>{{ resourceFile.getMetaData.getTimeUploaded|date('g:ia M j') }}</td>
                        {% if resourceFile.getMetaData.getSize == -1 %}
                        <td><i class="icon-spinner icon-spin icon-large"></i></td>
                        {% else %}
                        <td>{{ '%.2f' |format(resourceFile.getMetaData.getSize / 1024 /1024)  }}MB</td>
                        {% endif %}
                    </tr>
                    {% endfor %}
                {% else %}
                    <tr>{{  'filesGateway.noFiles'|trans }}</tr>
                {% endif %}
            </table>
	
	</div>
	<script type='text/javascript'>
        $('.preview-button').click(function(e) {
            if ($(this).hasClass('disabled'))
                return false;
            $('#preview').html('');
        	previewFileLink($(this), $('#preview'), true);
        	return false;
        });
        $('.select-button').click(function(e) {
            if ($(this).hasClass('disabled'))
                return false;
            mediaChooser.terminatingFunction($(this).attr('data-val'));
        	return false;
        });
        $('#record-link').click(function(e) {
            var recorderConfiguration = {forwardButton: true, forwardFunction: "forwardFunction", recordingSuccessFunction: "callBack"};
        	popUp($('#preview'), recordVideo($('#preview'), $(this).attr('href'), recorderConfiguration), "Record");
        	return false;
        });
	</script>
	<div id="preview">
	</div>


