{#
included by:
_Post:post.html.twig
#}

{% if isAjaxRequest is not defined %}
    {% set isAjaxRequest = false %}
{% endif %}

<div class="row" id="containerPost{{ post.id }}">
    <div class="col-md-12">
        <div class="text-right tt-date">
            {{ post.created|date('o-m-N H:i') }}
            {% if post.editedBy is not null %}
                (edited at {{ post.editedAt|date('o-m-N H:i') }} by {{ post.editedBy.username }})
            {% endif %}
        </div>
    </div>
    <div class="col-md-12">
        {% if post.attachedFile|length != 0 %}
            <div>
                {% include 'IMDCTerpTubeBundle:_Media:element.html.twig' with {'mediaFile': post.attachedFile[0]} %}
            </div>
        {% endif %}
        {% if post.isTemporal %}
            <div class="tt-post-timeline-container">
                <div class="tt-post-timeline">
                    <div class="tt-post-timeline-keypoint post-timeline-keypoint" data-pid="{{ post.id }}"></div>
                </div>
            </div>
        {% endif %}
        <div>
            <p>{{ post.content|nl2br }}</p>
        </div>
    </div>
    {% if isAjaxRequest %}
        <script type="text/javascript">
            var postContainer = $(".tt-post-container[data-pid=\"{{ post.id }}\"]");
            postContainer.data("starttime", "{{ post.startTime }}");
            postContainer.data("endtime", "{{ post.endTime }}");
            postContainer.data("istemporal", "{{ post.isTemporal }}");

            context.replaceKeyPoint(new KeyPoint(
                    postContainer.data("pid"),
                    postContainer.data("starttime"),
                    postContainer.data("endtime"),
                    "comment",
                    {
                        drawOnTimeLine: postContainer.data("istemporal")
                    }
            ));
        </script>
    {% endif %}
</div>
