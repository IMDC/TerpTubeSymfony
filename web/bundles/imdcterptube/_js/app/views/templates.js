!function(){function e(e,r){return e.helper("select",r,{block:t},{key:r.getPath(!1,["media","type"])})}function t(e,t){return e.helper("eq",t,{block:r},{value:1}).helper("eq",t,{block:a},{value:2}).helper("eq",t,{block:n},{value:0}).helper("eq",t,{block:o},{value:9})}function r(e,t){return e.write('<video class="tt-media-video" style="height: 100%;" ').notexists(t.get(["enableControls"],!1),t,{block:i},null).write(' poster="').helper("generateUrl",t,{},{path:t.getPath(!1,["media","thumbnail"])}).write('" preload="metadata"><source src="').helper("generateUrl",t,{},{path:t.getPath(!1,["media","resource","pathMPEG"])}).write('" /></video>')}function i(e){return e.write("controls")}function a(e,t){return e.write('<audio class="tt-media-audio" ').notexists(t.get(["enableControls"],!1),t,{block:l},null).write('><source src="').helper("generateUrl",t,{},{path:t.getPath(!1,["media","resource","pathMPEG"])}).write('" /></audio>')}function l(e){return e.write("controls")}function n(e,t){return e.write('<img class="" style="max-height: 100%; max-width: 100%;" src="').helper("generateUrl",t,{},{path:t.getPath(!1,["media","resource","pathMPEG"])}).write('" title="').reference(t.get(["title"],!1),t,"h").write('" alt="').reference(t.get(["title"],!1),t,"h").write('" /><span style="vertical-align: middle; display: inline-block; height: 100%;"></span>')}function o(e,t){return e.write('<div class="row"><div class="col-md-3 thumbnail text-center"><a href="').helper("generateUrl",t,{},{path:t.getPath(!1,["media","resource","pathMPEG"])}).write('"><p><i class="fa fa-file fa-5x"></i></p><div>').reference(t.get(["title"],!1),t,"h").write("</div></a></div></div>")}return dust.register("gallery_media",e),e}();
;!function(){function i(i){return i.write('<div class="gallery-normal" style="position: relative;"><div class="gallery-normal-item"></div><div class="gallery-normal-action" style="position: absolute; top: 10px; right: 10px; background-color: #000; opacity: 0.8;"><a style="color: #fff; padding: 4px 8px; cursor: pointer; display: none;" title="Interpret" data-action="3"><i class="fa fa-video-camera fa-2x"></i></a></div><div style="position: relative; width:100%; margin-bottom: 8px;"><div style="overflow: hidden; position: relative; height: 90px;  margin-left: 55px; margin-right: 55px;"><ol class="gallery-normal-thumbs" style="width: 10000px; margin: 0; list-style: none; position: absolute; left: 0; overflow: hidden; padding: 0px; height: 100%; white-space: nowrap; text-align: center;"></ol></div><div class="gallery-normal-left" style="position: absolute; left: 10px; bottom: 24px; cursor: pointer; display: none;"><i class="fa fa-chevron-left fa-3x"></i></div><div class="gallery-normal-right" style="position: absolute; right: 10px; bottom: 24px; cursor: pointer; display: none;"><i class="fa fa-chevron-right fa-3x"></i></div></div></div>')}return dust.register("gallery_normal",i),i}();
;!function(){function i(i){return i.write('<div class="gallery-preview" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 100000; background-color: #000; opacity: 0.8; display: none;"></div><div class="gallery-preview" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 100001; display: none;"><div class="gallery-preview-action" style="position: absolute; top: 10px; right: 10px; background-color: #000; opacity: 0.8;"><a style="color: #fff; padding: 4px 8px; cursor: pointer; display: none;" title="Cut" data-action="4"><i class="fa fa-scissors fa-3x"></i></a><a style="color: #fff; padding: 4px 8px; cursor: pointer; display: none;" title="Interpret" data-action="3"><i class="fa fa-video-camera fa-3x"></i></a><a style="color: #fff; padding: 4px 8px; cursor: pointer;" data-action="2"><i class="fa fa-expand fa-3x" style="font-size: 2.5em;"></i></a><a style="color: #fff; padding: 4px 8px; cursor: pointer;" data-action="1"><i class="fa fa-times fa-3x"></i></a></div><div class="gallery-preview-prev" style="left: 0; background-color: #000; color: #fff; opacity: 0.8; position: absolute; line-height: 80px; cursor: pointer; height: 80px; width: 80px; text-align: center; display: none;"><i class="fa fa-chevron-left fa-3x" style="vertical-align: middle;"></i></div><div class="gallery-preview-next" style="right: 0; background-color: #000; color: #fff; opacity: 0.8; position: absolute; line-height: 80px; cursor: pointer; height: 80px; width: 80px; text-align: center; display: none;"><i class="fa fa-chevron-right fa-3x" style="vertical-align: middle;"></i></div><div class="gallery-preview-item" style="width: 70%; top: 70px; margin: 0 auto; transition: 0.2s; -webkit-transition: 0.2s; text-align: center; white-space: nowrap; position: relative; border: 0px solid red; color: #fff;"><i class="fa fa-spinner fa-4x fa-spin"></i><span style="vertical-align: middle; display: inline-block; height: 100%;"></span></div><div style="overflow: hidden; position: absolute; left: 0; right: 0; bottom: 0; margin-bottom: 8px; margin-left: 55px; margin-right: 55px;"><ol class="gallery-preview-thumbs" style="width: 10000px; margin: 0; list-style: none; position: relative; overflow: hidden; padding: 0; height: 100%; white-space: nowrap; text-align: center; display: none;"></ol></div><div class="gallery-preview-left" style="color: #fff; position: absolute; left: 10px; bottom: 0; line-height: 90px; cursor: pointer; display: none;"><i class="fa fa-chevron-left fa-3x"></i></div><div class="gallery-preview-right" style="color: #fff; position: absolute; right: 10px; bottom: 0; line-height: 90px; cursor: pointer; display: none;"><i class="fa fa-chevron-right fa-3x"></i></div></div>')}return dust.register("gallery_preview",i),i}();
;!function(){function e(e,i){return e.section(i.get(["media"],!1),i,{block:t},null)}function t(e,t){return e.write('<li style="float: left; list-style: none; margin-right: 5px; cursor: pointer; height: 100%; border: 2px solid black;" data-mid="').reference(t.get(["id"],!1),t,"h").write('"><img style="max-height: 100%; width: 100%;" src="').helper("generateUrl",t,{},{path:t.get(["thumbnail"],!1)}).write('" /><span style="vertical-align: middle; display: inline-block; height: 100%;"></span></li>')}return dust.register("gallery_thumbnail",e),e}();
;!function(){function a(a){return a.write('<div class="modal fade my-files-selector-modal"><div class="modal-dialog" style="width: 80%;"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button><h4 class="modal-title">Select from My Files</h4></div><div class="modal-body"><div class="text-center"><i class="fa fa-spinner fa-4x fa-spin"></i></div></div><div class="modal-footer"><a class="btn btn-default" data-dismiss="modal"><i class="fa fa-times"></i> Cancel</a><a class="btn btn-primary my-files-selector-select-selected" disabled="disabled" data-loading-text="<i class=&quot;fa fa-spinner fa-spin&quot;></i> Downloading data..."><i class="fa fa-check"></i> Select</a></div></div></div></div>')}return dust.register("myFilesSelector",a),a}();
define(["controller/post_","core/mediaChooser"],function(i,t){"use strict";var e=function(n,o){this.controller=new i(n,o),this.bind__onClickHoverTimelineKeyPoint=this._onClickHoverTimelineKeyPoint.bind(this),this.bind__onClickNew=this._onClickNew.bind(this),this.bind__onClickEdit=this._onClickEdit.bind(this),this.bind__onClickDelete=this._onClickDelete.bind(this),this.bind__onClickSubmitNew=this._onClickSubmitNew.bind(this),this.bind__onClickSubmitEdit=this._onClickSubmitEdit.bind(this),this.bind__onClickReset=this._onClickReset.bind(this),this.bind__onClickCancelNew=this._onClickCancelNew.bind(this),this.bind__onClickCancelEdit=this._onClickCancelEdit.bind(this),this.bind__onSuccess=this._onSuccess.bind(this),this.bind__onSuccessAndPost=this._onSuccessAndPost.bind(this),this.bind__onReset=this._onReset.bind(this),this.bind__renderTimelineKeyPoint=this._renderTimelineKeyPoint.bind(this),this.bind__onSelectionTimes=this._onSelectionTimes.bind(this),this.bind__onHoverKeyPoint=this._onHoverKeyPoint.bind(this),this.bind__onClickKeyPoint=this._onClickKeyPoint.bind(this),this.$container=$(e.Binder.CONTAINER+"[data-pid='"+n.id+"']"),this.$form=this.$container.find("form[name^="+e.FORM_NAME+"]"),this.$timelineKeyPoint=this.$container.find(e.Binder.TIMELINE_KEYPOINT),this.$new=this.$container.find(e.Binder.NEW),this.$edit=this.$container.find(e.Binder.EDIT),this.$deleteModal=this.$container.find(e.Binder.DELETE_MODAL),this.$delete=this.$container.find(e.Binder.DELETE),this.$submitNew=this.$container.find(e.Binder.SUBMIT_NEW),this.$submitEdit=this.$container.find(e.Binder.SUBMIT_EDIT),this.$reset=this.$container.find(e.Binder.RESET),this.$cancelNew=this.$container.find(e.Binder.CANCEL_NEW),this.$cancelEdit=this.$container.find(e.Binder.CANCEL_EDIT),this.$timelineKeyPoint.on("click",this.bind__onClickHoverTimelineKeyPoint),this.$timelineKeyPoint.on("dblclick",this.bind__onClickHoverTimelineKeyPoint),this.$timelineKeyPoint.hover(this.bind__onClickHoverTimelineKeyPoint,this.bind__onClickHoverTimelineKeyPoint),this.$new.on("click",this.bind__onClickNew),this.$edit.on("click",this.bind__onClickEdit),this.$delete.on("click",this.bind__onClickDelete),this.$submitNew.on("click",this.bind__onClickSubmitNew),this.$submitEdit.on("click",this.bind__onClickSubmitEdit),this.$reset.on("click",this.bind__onClickReset),this.$cancelNew.on("click",this.bind__onClickCancelNew),this.$cancelEdit.on("click",this.bind__onClickCancelEdit),this.mediaChooser=new t({enableDoneAndPost:!0}),$(this.mediaChooser).on(t.Event.SUCCESS,this.bind__onSuccess),$(this.mediaChooser).on(t.Event.SUCCESS_AND_POST,this.bind__onSuccessAndPost),$(this.mediaChooser).on(t.Event.RESET,this.bind__onReset),this.mediaChooser.setContainer(this.$form),this.mediaChooser.bindUIEvents();var s=[];this._getFormField("attachedFile").children().each(function(i,t){s.push($(t).val())}),s.length>0&&(this._toggleForm(!0),this.mediaChooser.setMedia(s)),this.keyPointService=$tt._services.keyPoint,$(this.keyPointService).on("eventDuration",this.bind__renderTimelineKeyPoint),$(this.keyPointService).on("eventSelectionTimes",this.bind__onSelectionTimes),$(this.keyPointService).on("eventKeyPointHover",this.bind__onHoverKeyPoint),$(this.keyPointService).on("eventKeyPointClick",this.bind__onClickKeyPoint),this.controller.onViewLoaded()};return e.TAG="PostView",e.Binder={CONTAINER:".post-container",TIMELINE_KEYPOINT:".post-timeline-keypoint",NEW:".post-new",EDIT:".post-edit",DELETE_MODAL:".post-delete-modal",DELETE:".post-delete",SUBMIT_NEW:".post-submit-new",SUBMIT_EDIT:".post-submit-edit",RESET:".post-reset",CANCEL_NEW:".post-cancel-new",CANCEL_EDIT:".post-cancel-edit"},e.FORM_NAME="post",e.prototype._getFormField=function(i){return this.$form.find("#"+e.FORM_NAME+"_"+i)},e.prototype._onClickHoverTimelineKeyPoint=function(i){i&&"click"==i.type&&i.preventDefault(),this.controller.interactKeyPoint(i.type)},e.prototype._onClickNew=function(i){i.preventDefault(),this.$new.hide(),this.controller.new(null).done(function(i){this.$container.after(i.html)}.bind(this)).fail(function(){this.$new.show()}.bind(this))},e.prototype._onClickEdit=function(i){i.preventDefault(),this.controller.edit(null).done(function(i){this.$container.replaceWith(i.html);var t=this;t=new e(this.controller.model,this.controller.options)}.bind(this))},e.prototype._onClickDelete=function(i){i.preventDefault(),this.view.$delete.button("loading"),this.controller.delete().done(function(){this.$deleteModal.find(".modal-body").html("Post deleted successfully."),this.$deleteModal.data("bs.modal").isShown?(this.$deleteModal.on("hidden.bs.modal",function(){this.$container.remove()}),this.$deleteModal.modal("hide"),this.$container.fadeOut("slow")):this.$container.fadeOut("slow",function(){this.$container.remove()})}.bind(this)).fail(function(){this.$container.find(".modal-body").prepend("Something went wrong. Try again."),this.$delete.button("reset")}.bind(this))},e.prototype._toggleForm=function(i){this.$submitNew.button(i?"loading":"reset"),this.$submitEdit.button(i?"loading":"reset"),this.$reset.attr("disabled",i),this.$cancelNew.attr("disabled",i),this.$cancelEdit.attr("disabled",i)},e.prototype._preSubmit=function(){return""==this._getFormField("content").val()&&0==this.mediaChooser.media.length?(alert("Your post cannot be blank. You must either select a file or write a comment."),!1):(this._toggleForm(!0),!0)},e.prototype._onClickSubmitNew=function(i){i.preventDefault(),this._preSubmit()&&this.controller.new(this.$form[0]).done(function(i){if(!i.wasReplied){this.$container.replaceWith(i.html);var t=this;t=new e(this.controller.model,this.controller.options)}}.bind(this)).fail(function(){this._toggleForm(!1)}.bind(this))},e.prototype._onClickSubmitEdit=function(i){i.preventDefault(),this._preSubmit()&&this.controller.edit(this.$form[0]).done(function(i){this.$container.replaceWith(i.html);var t=this;t=new e(this.controller.model,this.controller.options)}.bind(this)).fail(function(){this._toggleForm(!1)}.bind(this))},e.prototype._onClickReset=function(i){i.preventDefault(),this.mediaChooser.reset(),this._getFormField("startTime").val(this.controller.keyPoint.startTime),this._getFormField("endTime").val(this.controller.keyPoint.endTime),this._getFormField("content").val(""),this.controller.editKeyPoint()},e.prototype._onClickCancelNew=function(i){i.preventDefault(),this.$container.remove(),this.controller.removeKeyPoint(),$(e.Binder.CONTAINER+"[data-pid='"+this.controller.model.parentPostId+"']").find(e.Binder.NEW).show()},e.prototype._onClickCancelEdit=function(i){i.preventDefault(),this.controller.view(this.model).done(function(i){this.$container.replaceWith(i.html);var t=this;t=new e(this.controller.model,this.controller.options)}.bind(this))},e.prototype._updateForm=function(){var i=this._getFormField("attachedFile");i.html(this.mediaChooser.generateFormData(i.data("prototype")))},e.prototype._onSuccess=function(){this._updateForm(),this._toggleForm(!1)},e.prototype._onSuccessAndPost=function(){this._updateForm(),this.$submit.trigger("click")},e.prototype._onReset=function(){this._updateForm()},e.prototype._renderTimelineKeyPoint=function(i){console.log("%s: %s",e.TAG,"_renderTimelineKeyPoint");var t=(100*this.controller.keyPoint.startTime/i.duration).toFixed(2),n=(100*this.controller.keyPoint.endTime/i.duration).toFixed(2),o=(n-t).toFixed(2);this.$timelineKeyPoint.css({left:t+"%",width:o+"%"})},e.prototype._onSelectionTimes=function(i){this._getFormField("startTime").val(i.selection.startTime),this._getFormField("endTime").val(i.selection.endTime)},e.prototype._onHoverKeyPoint=function(i){i.keyPoint.id==this.controller.keyPoint.id&&this.$container.toggleClass("tt-post-container-highlight")},e.prototype._onClickKeyPoint=function(i){if(i.keyPoint.id==this.controller.keyPoint.id){var t=this.$container.find("video")[0];t&&(t.currentTime=0,t.play())}},e});
;!function(){function e(e){return e.write('<div class="modal fade recorder-modal"><div class="modal-dialog modal-lg"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button><h4 class="modal-title">Recorder</h4></div><div class="modal-body"><div class="recorder-container-record"><ul class="nav nav-tabs" role="tablist"><li class="active"><a href=".recorder-normal" role="tab" data-toggle="tab">Normal</a></li><li><a href=".recorder-interp" role="tab" data-toggle="tab">Interpretation</a></li></ul><div class="tab-content" style="padding-top: 15px;"><div class="tab-pane active recorder-normal"><div class="tt-media-preview-title"><input class="recorder-normal-title" style="display: none;" type="text" value="" /></div><video class="recorder-normal-video" width="100%" preload="auto" muted="muted"><source src="" /></video></div><div class="tab-pane recorder-interp"><div style="border: 2px dashed #ccc; line-height: 200px; height: 200px; text-align: center; display: none;"><button class="btn btn-primary btn-lg recorder-interp-select">Select a video to interpret</button></div><div class="row"><div class="col-md-6"><video class="recorder-interp-video-p" style="display: none;" width="100%" preload="auto" muted="muted"><source src="" /></video></div><div class="col-md-6"><div class="tt-media-preview-title"><input class="recorder-interp-title" style="display: none;" type="text" value="" /></div><video class="recorder-interp-video-r" style="display: none;" width="100%" preload="auto" muted="muted"><source src="" /></video></div></div></div></div><div class="recorder-controls"></div></div><div class="recorder-container-upload" style="display: none;"><label>Uploading...</label><div class="progress"><div class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%;">0%</div></div></div></div></div></div></div>')}return dust.register("recorder",e),e}();
define(["controller/thread_","core/mediaChooser"],function(e,t){"use strict";var i=function(o,n){this.controller=new e(o,n),this.bind__onClickSubmit=this._onClickSubmit.bind(this),this.bind__onClickDelete=this._onClickDelete.bind(this),this.bind__onClickVideoSpeed=this._onClickVideoSpeed.bind(this),this.bind__onClickClosedCaptions=this._onClickClosedCaptions.bind(this),this.bind__onSuccess=this._onSuccess.bind(this),this.bind__onReset=this._onReset.bind(this),this.$container=n.container,this.$form=this.$container.find("form[name^="+i.FORM_NAME+"]"),this.$submit=this.$container.find(i.Binder.SUBMIT),this.$deleteModal=this.$container.find(i.Binder.DELETE_MODAL),this.$delete=this.$container.find(i.Binder.DELETE),this.$submit.on("click",this.bind__onClickSubmit),this.$delete.on("click",this.bind__onClickDelete),$("#videoSpeed").on("click",this.bind__onClickVideoSpeed),$("#closedCaptions").on("click",this.bind__onClickClosedCaptions),this.mediaChooser=new t,$(this.mediaChooser).on(t.Event.SUCCESS,this.bind__onSuccess),$(this.mediaChooser).on(t.Event.RESET,this.bind__onReset),this.mediaChooser.setContainer(this.$form),this.mediaChooser.bindUIEvents();var d=[];this._getFormField("mediaIncluded").children().each(function(e,t){d.push($(t).val())}),d.length>0&&(this.$submit.attr("disabled",!0),this.mediaChooser.setMedia(d)),this.controller.onViewLoaded()};return i.TAG="ThreadView",i.Binder={SUBMIT:".thread-submit",DELETE_MODAL:".thread-delete-modal",DELETE:".thread-delete"},i.FORM_NAME="thread",i.prototype._getFormField=function(e){return this.$form.find("#"+i.FORM_NAME+"_"+e)},i.prototype._onClickSubmit=function(e){this.$form[0].checkValidity()&&$(e.target).button("loading")},i.prototype._onClickDelete=function(e){e.preventDefault(),this.$delete.button("loading"),this.controller.delete().done(function(){this.$deleteModal.find(".modal-body").html("Topic deleted successfully.")}.bind(this)).fail(function(){this.$container.find(".modal-body").prepend("Something went wrong. Try again."),this.$delete.button("reset")}.bind(this))},i.prototype._onClickVideoSpeed=function(e){e.preventDefault();var t=this.controller.adjustVideoSpeed();$("#videoSpeed img").attr("src",t)},i.prototype._onClickClosedCaptions=function(e){e.preventDefault();var t=this.controller.toggleClosedCaptions();$("#closed-caption-button img").attr("src",t)},i.prototype._updateForm=function(){var e=this._getFormField("mediaIncluded");e.html(this.mediaChooser.generateFormData(e.data("prototype")))},i.prototype._onSuccess=function(){this._updateForm(),this.$submit.attr("disabled",!1),this.mediaChooser.media.length>0&&this._getFormField("title").attr("required",!1).parent().find("label").removeClass("required")},i.prototype._onReset=function(){this._updateForm(),0==this.mediaChooser.media.length&&this._getFormField("title").attr("required",!0).parent().find("label").addClass("required")},i});